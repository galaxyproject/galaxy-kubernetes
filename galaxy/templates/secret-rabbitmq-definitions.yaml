{{ if .Values.rabbitmq.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-rabbitmq-load-definitions
type: Opaque
stringData:
  load_definition.json: |
    {
       "vhosts": [
         {
           "name": "{{ .Values.rabbitmq.galaxy.vhost }}"
         }
        ],
       "users": [
         {
           "name": "{{ .Values.rabbitmq.galaxy.user }}",
           "password": "{{ .Values.rabbitmq.galaxy.password }}",
           "tags": ""
         }
       ],
       "permissions": [
         {
           "user": "{{ .Values.rabbitmq.galaxy.user }}",
           "vhost": "{{ .Values.rabbitmq.galaxy.vhost }}",
           "configure": ".*",
           "write": ".*",
           "read": ".*"
         }
        ]
    }
{{ end }}
